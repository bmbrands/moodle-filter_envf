function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("filter_envf/userprofileform",["jquery","core/str","core/fragment","core/templates","core/ajax","core/notification"],function(a,b,c,d,e,f){var g=function(a,b,c){this.formelementcontainer=a;this.contextid=b;this.userid=c;a.on("submit","form",this.submitFormAjax.bind(this))},h=["id","username","auth","suspended","firstname","lastname","email","maildisplay","city","country","timezone","description","userpicture","firstnamephonetic","lastnamephonetic","middlename","alternatename","interests","url","icq","skype","aim","yahoo","msn","idnumber","institution","department","phone1","phone2","address","lang","calendartype","theme","mailformat","customfields","preferences"];g.prototype.submitFormAjax=function(b){b.preventDefault();var f=document.createEvent("HTMLEvents");f.initEvent("change",!0,!0);var g=a(this.formelementcontainer).find("form");g.find(":input").each(function(a,b){b.dispatchEvent(f)});var i=a.merge(g.find("[aria-invalid=\"true\"]"),g.find(".error"));if(i.length){i.first().focus();return}var j=this.formelementcontainer,k=JSON.stringify(g.serialize()),l=this;c.loadFragment("filter_envf","userprofile_form",this.contextid,{jsonformdata:k}).then(function(b,c){d.replaceNodeContents(j,b,c);if(j.children(".upf-userformvalidated").data("validated")){var f=a(j.find("form")).serializeArray().reduce(function(a,b){if(h.includes(b.name)){a[b.name]=b.value}return a},{});if(_typeof(f.newpassword)!==void 0){delete f.newpassword}if(_typeof(f.password)!==void 0){delete f.password}e.call([{methodname:"filter_envf_update_user",args:{userdata:f},done:l.handleFormSubmissionResponse.bind(l,f),fail:l.handleFormSubmissionFailure.bind(l,f)}])}})};g.prototype.handleFormSubmissionResponse=function(a){b.get_string("userupdated","filter_envf",a).done(function(a){f.addNotification({message:a,type:"info"})})};g.prototype.handleFormSubmissionFailure=function(a){b.get_string("userupdated","filter_envf",a).done(function(a){f.addNotification({message:a,type:"warning"})})};return{init:function init(b){a(document).ready(function(){a("."+b.classmarker).each(function(){var b=a(this).data("userid"),e=a(this).data("contextid"),f=a(this);c.loadFragment("filter_envf","userprofile_form",e,{}).then(function(a,c){d.replaceNodeContents(f,a,c);new g(f,e,b)})})})}}});
//# sourceMappingURL=userprofileform.min.js.map
